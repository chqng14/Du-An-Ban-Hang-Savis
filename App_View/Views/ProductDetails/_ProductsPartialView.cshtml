@model App_Data.ViewModels.Filter.FilterVM
@if (Model.Items!.Any())
{
    <div class="category-page-wrapper mb_30">
        <div class="list-grid-wrapper pull-left">
            <div class="btn-group btn-list-grid">
                <button type="button" id="grid-view" class="btn btn-default grid-view active"></button>
                <button type="button" id="list-view" class="btn btn-default list-view"></button>
            </div>
        </div>
        @*<div class="page-wrapper pull-right">
                <label class="control-label" for="input-limit">Show :</label>
                <div class="limit">
                    <select id="input-limit" class="form-control">
                        <option value="8" selected="selected">08</option>
                        <option value="25">25</option>
                        <option value="50">50</option>
                        <option value="75">75</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <span><i class="fa fa-angle-down" aria-hidden="true"></i></span>
            </div>*@
        <div class="sort-wrapper pull-right">
            <label class="control-label" for="input-sort">Sort By :</label>
            <div class="sort-inner">
                <select id="input-sort" class="form-control">
                    <option value="ASC" selected="selected">Default</option>
                    <option value="ASC">Name (A - Z)</option>
                    <option value="DESC">Name (Z - A)</option>
                    <option value="ASC">Price (Low &gt; High)</option>
                    <option value="DESC">Price (High &gt; Low)</option>
                    <option value="DESC">Rating (Highest)</option>
                    <option value="ASC">Rating (Lowest)</option>
                    <option value="ASC">Model (A - Z)</option>
                    <option value="DESC">Model (Z - A)</option>
                </select>
            </div>
            <span><i class="fa fa-angle-down" aria-hidden="true"></i></span>
        </div>
    </div>
    <div class="row">
        @foreach (var item in Model.Items)
        {
            <div class="product-layout product-grid col-md-4 col-xs-6 ">
                <div class="item">
                    <div class="product-thumb clearfix mb_30">
                        <div class="image product-imageblock">
                            @if (@item.LstTenAnh.Count >= 2)
                            {
                                <a href="ProductDetails/Details/@item.Id"> <img style="height:220px" data-name="product_image" src="/images/anhsanpham/@item.LstTenAnh[0]" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> <img style="height:220px" src="/images/anhsanpham/@item.LstTenAnh[0]" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> </a>
                            }
                            else if (@item.LstTenAnh.Count == 1)
                            {
                                <a href="ProductDetails/Details/@item.Id"> <img style="height:220px" data-name="product_image" src="/images/anhsanpham/@item.LstTenAnh[0]" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> <img style="height:220px" src="/images/anhsanpham/@item.LstTenAnh[0]" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> </a>
                            }
                            else if (@item.LstTenAnh.Count == 0)
                            {
                                <a href="ProductDetails/Details/@item.Id"> <img style="height:220px" data-name="product_image" src="/images/anhsanpham/noAnh.png" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> <img style="height:220px" src="/images/anhsanpham/noAnh.png" alt="iPod Classic" title="iPod Classic" class="img-responsive" /> </a>
                            }
                            <div class="button-group text-center">
                                <div class="add-to-cart" onclick="window.location.href = '/ProductDetails/Details/@item.Id'" style="background-color: rgba(0, 128, 0, 0.25);border-radius: 50%;"><a href="/ProductDetails/Details/@item.Id"><span>Add to cart</span></a></div>
                            </div>
                        </div>
                        <div class="caption product-detail text-center">
                            <h6 data-name="product_name" class="product-name mt_20"><a href="/ProductDetails/Details/@item.Id" title="Casual Shirt With Ruffle Hem">@item.Loai @item.NameProduct</a></h6>
                            <div class="rating"> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i><i class="fa fa-star fa-stack-1x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i><i class="fa fa-star fa-stack-1x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i><i class="fa fa-star fa-stack-1x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i><i class="fa fa-star fa-stack-1x"></i></span> <span class="fa fa-stack"><i class="fa fa-star-o fa-stack-1x"></i><i class="fa fa-star fa-stack-x"></i></span> </div>
                            <span class="price">
                                <span class="amount">
                                    <span class="currencySymbol">
                                        @string.Format(new System.Globalization.CultureInfo("vi-VN"), "{0:C0}", item.GiaBan)
                                    </span>
                                </span>
                            </span>
                            <p class="product-desc mt_20 mb_60"> More room to move. With 80GB or 160GB of storage and up to 40 hours of battery life, the new iPod classic lets you enjoy up to 40,000 songs or up to 200 hours of video or any combination wherever you go.Cover Flow. Browse through your music collection by flipping..</p>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
    <div class="pagination-nav text-center mt_50">
        <ul>
            @if (Model.PagingInfor!.SoTrang > 1)
            {
                <li><a href="javacript:void(0);"><i class="fa fa-angle-left"></i></a></li>
                @for (int i = 1; i <= Model.PagingInfor!.SoTrang; i++)
                {
                    if (i == Model.PagingInfor.TrangHienTai)
                    {
                        <li class="active"><a href="javacript:void(0);">@i</a></li>
                    }
                    else
                    {
                        <li class="no-active"><a href="javacript:void(0);">@i</a></li>
                    }
                }
                <li><a href="javacript:void(0);"><i class="fa fa-angle-right"></i></a></li>
            }


        </ul>
    </div>
}
else
{
    <div style="display: flex; flex-direction: column; align-items: center; text-align: center;">
        <span style="color: red; font-size: 27px;">
            Không sản phẩm nào được tìm thấy!!!
        </span>
        <br />
        <button style="border: none; border-radius: 5px; background: white; padding: 10px;" onclick="window.location.href='/ProductDetails'">Xóa bộ lọc</button>
    </div>
}
<script>
    $(document).one("click", ".no-active", function () {
        const brandParam = new URLSearchParams(window.location.search).get("brand");

        var trangHienTai = $(this).text()

        let lstColor = $('#filter-color').find('input[type="checkbox"]:checked').map(function () {
            return $(this).val();
        }).get();

        let lstSize = $('#filter-size').find('input[type="checkbox"]:checked').map(function () {
            return $(this).val();
        }).get();
        var currentAmount = $("#amount").val();

        var values = currentAmount.split('-');

        var minValue = values[0].replace(/[^0-9]/g, "");
        var maxValue = values[1].replace(/[^0-9]/g, "");


        var data = {
            GiaMin: minValue,
            GiaMax: maxValue,
            ListCorlor: lstColor,
            ListSize: lstSize,
            TrangHienTai: trangHienTai,
        };
        $.ajax({
            url: brandParam != null ? '/ProductDetails/LoadPartialViewProducts?brand=' + brandParam : '/ProductDetails/LoadPartialViewProducts',
            type: 'POST',
            data: JSON.stringify(data),
            contentType: 'application/json',
            success: function (result) {
                $('.body-products').empty().html(result)
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                console.log(status);
                console.log(error);
                console.log(xhr);
            }
        });
    })
</script>
